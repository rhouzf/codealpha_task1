- name: Cr√©ation des pods
  k8s:
    state: present
    definition:
      apiVersion: v1
      kind: Pod
      metadata:
        name: "myapp-{{ item }}"
        namespace: "production"
      spec:
        containers:
          - name: "container-{{ item }}"
            image: nginx
            ports:
              - containerPort: 80
  loop: "{{ range(1, pod_count | int + 1) | list }}"
  loop_control:
    loop_var: item
  environment:
    KUBECONFIG: /home/ubuntu/.kube/config
